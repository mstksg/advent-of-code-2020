<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ImplicitParams    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      : AOC.Interactive</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   : (c) Justin Le 2018</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  : justin@jle.im</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability : non-portable</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Run actions regarding challenges, solutions, tests, submissions, viewing</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- prompts, etc.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Essentially implements the functionality of the main app.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">AOC.Run</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Options</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier">TestSpec</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Runners</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Run solutions, tests, benchmarks</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#MainRunOpts"><span class="hs-identifier">MainRunOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#HasMainRunOpts"><span class="hs-identifier">HasMainRunOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#mainRun"><span class="hs-identifier">mainRun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#defaultMRO"><span class="hs-identifier">defaultMRO</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** View prompts</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#MainViewOpts"><span class="hs-identifier">MainViewOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#HasMainViewOpts"><span class="hs-identifier">HasMainViewOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#mainView"><span class="hs-identifier">mainView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#defaultMVO"><span class="hs-identifier">defaultMVO</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Submit answers</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#MainSubmitOpts"><span class="hs-identifier">MainSubmitOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#HasMainSubmitOpts"><span class="hs-identifier">HasMainSubmitOpts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#mainSubmit"><span class="hs-identifier">mainSubmit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#defaultMSO"><span class="hs-identifier">defaultMSO</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Util</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AOC.Run.html#withColor"><span class="hs-identifier">withColor</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="AOC.Challenge.html"><span class="hs-identifier">AOC.Challenge</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="AOC.Run.Config.html"><span class="hs-identifier">AOC.Run.Config</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="AOC.Run.Load.html"><span class="hs-identifier">AOC.Run.Load</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="AOC.Solver.html"><span class="hs-identifier">AOC.Solver</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="AOC.Util.html"><span class="hs-identifier">AOC.Util</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Advent</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Criterion</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-keyword">hiding</span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Day</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.ANSI</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ANSI</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.Haskeline</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Specification of parts to test and run</span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="TestSpec"><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-var">TestSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TSAll"><span class="annot"><a href="AOC.Run.html#TSAll"><span class="hs-identifier hs-var">TSAll</span></a></span></span><span>
</span><span id="line-64"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="TSDayAll"><span class="annot"><a href="AOC.Run.html#TSDayAll"><span class="hs-identifier hs-var">TSDayAll</span></a></span></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_tsDay"><span class="annot"><span class="annottext">TestSpec -&gt; Day
</span><a href="AOC.Run.html#_tsDay"><span class="hs-identifier hs-var hs-var">_tsDay</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="TSDayPart"><span class="annot"><a href="AOC.Run.html#TSDayPart"><span class="hs-identifier hs-var">TSDayPart</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_tsSpec"><span class="annot"><span class="annottext">TestSpec -&gt; ChallengeSpec
</span><a href="AOC.Run.html#_tsSpec"><span class="hs-identifier hs-var hs-var">_tsSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Discover.html#ChallengeSpec"><span class="hs-identifier hs-type">ChallengeSpec</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679619996"><span id="local-6989586621679619998"><span id="local-6989586621679620007"><span class="annot"><span class="annottext">Int -&gt; TestSpec -&gt; ShowS
[TestSpec] -&gt; ShowS
TestSpec -&gt; String
(Int -&gt; TestSpec -&gt; ShowS)
-&gt; (TestSpec -&gt; String) -&gt; ([TestSpec] -&gt; ShowS) -&gt; Show TestSpec
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TestSpec] -&gt; ShowS
$cshowList :: [TestSpec] -&gt; ShowS
show :: TestSpec -&gt; String
$cshow :: TestSpec -&gt; String
showsPrec :: Int -&gt; TestSpec -&gt; ShowS
$cshowsPrec :: Int -&gt; TestSpec -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Options for 'mainRun'.</span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="MainRunOpts"><span class="annot"><a href="AOC.Run.html#MainRunOpts"><span class="hs-identifier hs-var">MainRunOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MRO"><span class="annot"><a href="AOC.Run.html#MRO"><span class="hs-identifier hs-var">MRO</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_mroSpec"><span class="annot"><span class="annottext">MainRunOpts -&gt; TestSpec
</span><a href="AOC.Run.html#_mroSpec"><span class="hs-identifier hs-var hs-var">_mroSpec</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-type">TestSpec</span></a></span><span>
</span><span id="line-70"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="_mroActual"><span class="annot"><span class="annottext">MainRunOpts -&gt; Bool
</span><a href="AOC.Run.html#_mroActual"><span class="hs-identifier hs-var hs-var">_mroActual</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="hs-comment">-- ^ Run input?  (Defualt: True</span><span>
</span><span id="line-71"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="_mroTest"><span class="annot"><span class="annottext">MainRunOpts -&gt; Bool
</span><a href="AOC.Run.html#_mroTest"><span class="hs-identifier hs-var hs-var">_mroTest</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="hs-comment">-- ^ Run tests?  (Default: False)</span><span>
</span><span id="line-72"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="_mroBench"><span class="annot"><span class="annottext">MainRunOpts -&gt; Bool
</span><a href="AOC.Run.html#_mroBench"><span class="hs-identifier hs-var hs-var">_mroBench</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="hs-comment">-- ^ Benchmark?  (Default: False)</span><span>
</span><span id="line-73"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="_mroLock"><span class="annot"><span class="annottext">MainRunOpts -&gt; Bool
</span><a href="AOC.Run.html#_mroLock"><span class="hs-identifier hs-var hs-var">_mroLock</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>     </span><span class="hs-comment">-- ^ Lock in answer as correct?  (Default: False)</span><span>
</span><span id="line-74"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="_mroInput"><span class="annot"><span class="annottext">MainRunOpts -&gt; Day -&gt; Part -&gt; IO (Maybe String)
</span><a href="AOC.Run.html#_mroInput"><span class="hs-identifier hs-var hs-var">_mroInput</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ Manually supply input (Default: always return Nothing)</span><span>
</span><span id="line-75"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="mroTest"><span id="mroSpec"><span id="mroLock"><span id="mroInput"><span id="mroBench"><span id="mroActual"><span id="mainRunOpts"><span id="local-6989586621679619925"><span id="local-6989586621679619929"><span id="local-6989586621679619933"><span id="local-6989586621679619937"><span id="local-6989586621679619941"><span id="local-6989586621679619945"><span id="local-6989586621679619948"><span id="local-6989586621679619955"><span id="local-6989586621679619961"><span id="local-6989586621679619967"><span id="local-6989586621679619973"><span id="local-6989586621679619979"><span id="local-6989586621679619986"><span id="local-6989586621679620407"><span id="HasMainRunOpts"><span class="hs-identifier">makeClassy</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">MainRunOpts</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Options for 'mainView'.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="MainViewOpts"><span class="annot"><a href="AOC.Run.html#MainViewOpts"><span class="hs-identifier hs-var">MainViewOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MVO"><span class="annot"><a href="AOC.Run.html#MVO"><span class="hs-identifier hs-var">MVO</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_mvoSpec"><span class="annot"><span class="annottext">MainViewOpts -&gt; TestSpec
</span><a href="AOC.Run.html#_mvoSpec"><span class="hs-identifier hs-var hs-var">_mvoSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-type">TestSpec</span></a></span><span>
</span><span id="line-81"></span><span>                        </span><span class="hs-special">,</span><span> </span><span id="_mvoWait"><span class="annot"><span class="annottext">MainViewOpts -&gt; Bool
</span><a href="AOC.Run.html#_mvoWait"><span class="hs-identifier hs-var hs-var">_mvoWait</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-82"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679619852"><span id="local-6989586621679619854"><span id="local-6989586621679619860"><span class="annot"><span class="annottext">Int -&gt; MainViewOpts -&gt; ShowS
[MainViewOpts] -&gt; ShowS
MainViewOpts -&gt; String
(Int -&gt; MainViewOpts -&gt; ShowS)
-&gt; (MainViewOpts -&gt; String)
-&gt; ([MainViewOpts] -&gt; ShowS)
-&gt; Show MainViewOpts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MainViewOpts] -&gt; ShowS
$cshowList :: [MainViewOpts] -&gt; ShowS
show :: MainViewOpts -&gt; String
$cshow :: MainViewOpts -&gt; String
showsPrec :: Int -&gt; MainViewOpts -&gt; ShowS
$cshowsPrec :: Int -&gt; MainViewOpts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="mvoWait"><span id="mvoSpec"><span id="mainViewOpts"><span id="local-6989586621679619829"><span id="local-6989586621679619833"><span id="local-6989586621679619836"><span id="local-6989586621679619843"><span id="local-6989586621679619850"><span id="local-6989586621679620385"><span id="HasMainViewOpts"><span class="hs-identifier">makeClassy</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">MainViewOpts</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Options for 'mainSubmit'</span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="MainSubmitOpts"><span class="annot"><a href="AOC.Run.html#MainSubmitOpts"><span class="hs-identifier hs-var">MainSubmitOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MSO"><span class="annot"><a href="AOC.Run.html#MSO"><span class="hs-identifier hs-var">MSO</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_msoSpec"><span class="annot"><span class="annottext">MainSubmitOpts -&gt; ChallengeSpec
</span><a href="AOC.Run.html#_msoSpec"><span class="hs-identifier hs-var hs-var">_msoSpec</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="AOC.Discover.html#ChallengeSpec"><span class="hs-identifier hs-type">ChallengeSpec</span></a></span><span>
</span><span id="line-89"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_msoTest"><span class="annot"><span class="annottext">MainSubmitOpts -&gt; Bool
</span><a href="AOC.Run.html#_msoTest"><span class="hs-identifier hs-var hs-var">_msoTest</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ Run tests before submitting?  (Default: True)</span><span>
</span><span id="line-90"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_msoForce"><span class="annot"><span class="annottext">MainSubmitOpts -&gt; Bool
</span><a href="AOC.Run.html#_msoForce"><span class="hs-identifier hs-var hs-var">_msoForce</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ Force submission even if bad?  (Default: False)</span><span>
</span><span id="line-91"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_msoLock"><span class="annot"><span class="annottext">MainSubmitOpts -&gt; Bool
</span><a href="AOC.Run.html#_msoLock"><span class="hs-identifier hs-var hs-var">_msoLock</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ Lock answer if submission succeeded?  (Default: True)</span><span>
</span><span id="line-92"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="_msoRetry"><span class="annot"><span class="annottext">MainSubmitOpts -&gt; Bool
</span><a href="AOC.Run.html#_msoRetry"><span class="hs-identifier hs-var hs-var">_msoRetry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="hs-comment">-- ^ If a wait is received after submission, try again automatically (Default: False)</span><span>
</span><span id="line-93"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679619797"><span id="local-6989586621679619799"><span id="local-6989586621679619807"><span class="annot"><span class="annottext">Int -&gt; MainSubmitOpts -&gt; ShowS
[MainSubmitOpts] -&gt; ShowS
MainSubmitOpts -&gt; String
(Int -&gt; MainSubmitOpts -&gt; ShowS)
-&gt; (MainSubmitOpts -&gt; String)
-&gt; ([MainSubmitOpts] -&gt; ShowS)
-&gt; Show MainSubmitOpts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MainSubmitOpts] -&gt; ShowS
$cshowList :: [MainSubmitOpts] -&gt; ShowS
show :: MainSubmitOpts -&gt; String
$cshow :: MainSubmitOpts -&gt; String
showsPrec :: Int -&gt; MainSubmitOpts -&gt; ShowS
$cshowsPrec :: Int -&gt; MainSubmitOpts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="msoTest"><span id="msoSpec"><span id="msoRetry"><span id="msoLock"><span id="msoForce"><span id="mainSubmitOpts"><span id="local-6989586621679619744"><span id="local-6989586621679619748"><span id="local-6989586621679619752"><span id="local-6989586621679619756"><span id="local-6989586621679619760"><span id="local-6989586621679619763"><span id="local-6989586621679619770"><span id="local-6989586621679619776"><span id="local-6989586621679619782"><span id="local-6989586621679619788"><span id="local-6989586621679619795"><span id="local-6989586621679620378"><span id="HasMainSubmitOpts"><span class="hs-identifier">makeClassy</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">MainSubmitOpts</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Default options for 'mainRun'.</span><span>
</span><span id="line-99"></span><span class="annot"><a href="AOC.Run.html#defaultMRO"><span class="hs-identifier hs-type">defaultMRO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-type">TestSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainRunOpts"><span class="hs-identifier hs-type">MainRunOpts</span></a></span><span>
</span><span id="line-100"></span><span id="defaultMRO"><span class="annot"><span class="annottext">defaultMRO :: TestSpec -&gt; MainRunOpts
</span><a href="AOC.Run.html#defaultMRO"><span class="hs-identifier hs-var hs-var">defaultMRO</span></a></span></span><span> </span><span id="local-6989586621679619699"><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619699"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MRO :: TestSpec
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; (Day -&gt; Part -&gt; IO (Maybe String))
-&gt; MainRunOpts
</span><a href="AOC.Run.html#MRO"><span class="hs-identifier hs-type">MRO</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_mroSpec :: TestSpec
</span><a href="AOC.Run.html#_mroSpec"><span class="hs-identifier hs-var">_mroSpec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619699"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-101"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mroActual :: Bool
</span><a href="AOC.Run.html#_mroActual"><span class="hs-identifier hs-var">_mroActual</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-102"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mroTest :: Bool
</span><a href="AOC.Run.html#_mroTest"><span class="hs-identifier hs-var">_mroTest</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-103"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mroBench :: Bool
</span><a href="AOC.Run.html#_mroBench"><span class="hs-identifier hs-var">_mroBench</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-104"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mroLock :: Bool
</span><a href="AOC.Run.html#_mroLock"><span class="hs-identifier hs-var">_mroLock</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-105"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mroInput :: Day -&gt; Part -&gt; IO (Maybe String)
</span><a href="AOC.Run.html#_mroInput"><span class="hs-identifier hs-var">_mroInput</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Day
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; IO (Maybe String)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-106"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Default options for 'mainView'.</span><span>
</span><span id="line-109"></span><span class="annot"><a href="AOC.Run.html#defaultMVO"><span class="hs-identifier hs-type">defaultMVO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-type">TestSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainViewOpts"><span class="hs-identifier hs-type">MainViewOpts</span></a></span><span>
</span><span id="line-110"></span><span id="defaultMVO"><span class="annot"><span class="annottext">defaultMVO :: TestSpec -&gt; MainViewOpts
</span><a href="AOC.Run.html#defaultMVO"><span class="hs-identifier hs-var hs-var">defaultMVO</span></a></span></span><span> </span><span id="local-6989586621679619698"><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619698"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVO :: TestSpec -&gt; Bool -&gt; MainViewOpts
</span><a href="AOC.Run.html#MVO"><span class="hs-identifier hs-type">MVO</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_mvoSpec :: TestSpec
</span><a href="AOC.Run.html#_mvoSpec"><span class="hs-identifier hs-var">_mvoSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619698"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-111"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_mvoWait :: Bool
</span><a href="AOC.Run.html#_mvoWait"><span class="hs-identifier hs-var">_mvoWait</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-112"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Default options for 'mainSubmit'.</span><span>
</span><span id="line-115"></span><span class="annot"><a href="AOC.Run.html#defaultMSO"><span class="hs-identifier hs-type">defaultMSO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Discover.html#ChallengeSpec"><span class="hs-identifier hs-type">ChallengeSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainSubmitOpts"><span class="hs-identifier hs-type">MainSubmitOpts</span></a></span><span>
</span><span id="line-116"></span><span id="defaultMSO"><span class="annot"><span class="annottext">defaultMSO :: ChallengeSpec -&gt; MainSubmitOpts
</span><a href="AOC.Run.html#defaultMSO"><span class="hs-identifier hs-var hs-var">defaultMSO</span></a></span></span><span> </span><span id="local-6989586621679619697"><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619697"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MSO :: ChallengeSpec -&gt; Bool -&gt; Bool -&gt; Bool -&gt; Bool -&gt; MainSubmitOpts
</span><a href="AOC.Run.html#MSO"><span class="hs-identifier hs-type">MSO</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_msoSpec :: ChallengeSpec
</span><a href="AOC.Run.html#_msoSpec"><span class="hs-identifier hs-var">_msoSpec</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619697"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-117"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_msoTest :: Bool
</span><a href="AOC.Run.html#_msoTest"><span class="hs-identifier hs-var">_msoTest</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_msoForce :: Bool
</span><a href="AOC.Run.html#_msoForce"><span class="hs-identifier hs-var">_msoForce</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_msoLock :: Bool
</span><a href="AOC.Run.html#_msoLock"><span class="hs-identifier hs-var">_msoLock</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-120"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_msoRetry :: Bool
</span><a href="AOC.Run.html#_msoRetry"><span class="hs-identifier hs-var">_msoRetry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-121"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="AOC.Run.html#filterChallengeMap"><span class="hs-identifier hs-type">filterChallengeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Run.html#TestSpec"><span class="hs-identifier hs-type">TestSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="AOC.Discover.html#ChallengeMap"><span class="hs-identifier hs-type">ChallengeMap</span></a></span><span>
</span><span id="line-124"></span><span id="filterChallengeMap"><span class="annot"><span class="annottext">filterChallengeMap :: TestSpec -&gt; Either String ChallengeMap
</span><a href="AOC.Run.html#filterChallengeMap"><span class="hs-identifier hs-var hs-var">filterChallengeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">TestSpec
</span><a href="AOC.Run.html#TSAll"><span class="hs-identifier hs-var">TSAll</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChallengeMap -&gt; Either String ChallengeMap
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="AOC.Challenge.html#challengeMap"><span class="hs-identifier hs-var">challengeMap</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="AOC.Run.html#TSDayAll"><span class="hs-identifier hs-type">TSDayAll</span></a></span><span> </span><span id="local-6989586621679619694"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619694"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ChallengeMap -&gt; Either String ChallengeMap
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Day not yet avaiable: %d&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><span class="hs-identifier hs-var">dayInt</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619694"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ChallengeMap -&gt; Either String ChallengeMap)
-&gt; Maybe ChallengeMap -&gt; Either String ChallengeMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-127"></span><span>                     </span><span class="annot"><span class="annottext">Day -&gt; Map Part SomeSolution -&gt; ChallengeMap
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619694"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Part SomeSolution -&gt; ChallengeMap)
-&gt; Maybe (Map Part SomeSolution) -&gt; Maybe ChallengeMap
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Day -&gt; ChallengeMap -&gt; Maybe (Map Part SomeSolution)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619694"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="AOC.Challenge.html#challengeMap"><span class="hs-identifier hs-var">challengeMap</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="AOC.Run.html#TSDayPart"><span class="hs-identifier hs-type">TSDayPart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-type">CS</span></a></span><span> </span><span id="local-6989586621679619686"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619686"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679619685"><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619685"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621679619684"><span class="annot"><span class="annottext">Map Part SomeSolution
</span><a href="#local-6989586621679619684"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe (Map Part SomeSolution)
-&gt; Either String (Map Part SomeSolution)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Day not yet available: %d&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><span class="hs-identifier hs-var">dayInt</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619686"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Map Part SomeSolution)
 -&gt; Either String (Map Part SomeSolution))
-&gt; Maybe (Map Part SomeSolution)
-&gt; Either String (Map Part SomeSolution)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-130"></span><span>              </span><span class="annot"><span class="annottext">Day -&gt; ChallengeMap -&gt; Maybe (Map Part SomeSolution)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619686"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="AOC.Challenge.html#challengeMap"><span class="hs-identifier hs-var">challengeMap</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621679619683"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619683"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe SomeSolution -&gt; Either String SomeSolution
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Part not found: %c&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Part -&gt; Char
</span><span class="hs-identifier hs-var">partChar</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619685"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe SomeSolution -&gt; Either String SomeSolution)
-&gt; Maybe SomeSolution -&gt; Either String SomeSolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-132"></span><span>              </span><span class="annot"><span class="annottext">Part -&gt; Map Part SomeSolution -&gt; Maybe SomeSolution
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619685"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Map Part SomeSolution
</span><a href="#local-6989586621679619684"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">Day -&gt; Map Part SomeSolution -&gt; ChallengeMap
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619686"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Part -&gt; SomeSolution -&gt; Map Part SomeSolution
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619685"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619683"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Run, test, bench.</span><span>
</span><span id="line-136"></span><span id="local-6989586621679620347"><span class="annot"><a href="AOC.Run.html#mainRun"><span class="hs-identifier hs-type">mainRun</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679620347"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679620347"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainRunOpts"><span class="hs-identifier hs-type">MainRunOpts</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679620347"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>  </span><span class="hs-comment">-- whether or not passed tests, and result</span><span>
</span><span id="line-141"></span><span id="mainRun"><span class="annot"><span class="annottext">mainRun :: forall (m :: * -&gt; *).
(MonadIO m, MonadError [String] m) =&gt;
Config
-&gt; MainRunOpts
-&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String)))
</span><a href="AOC.Run.html#mainRun"><span class="hs-identifier hs-var hs-var">mainRun</span></a></span></span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Cfg"><span class="hs-identifier hs-type">Cfg</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619639"><span id="local-6989586621679619640"><span class="annot"><span class="annottext">Integer
Maybe String
_cfgYear :: Config -&gt; Integer
_cfgSession :: Config -&gt; Maybe String
_cfgYear :: Integer
_cfgSession :: Maybe String
</span><a href="AOC.Run.Config.html#_cfgYear"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="AOC.Run.html#MRO"><span class="hs-identifier hs-type">MRO</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619631"><span id="local-6989586621679619632"><span id="local-6989586621679619633"><span id="local-6989586621679619634"><span id="local-6989586621679619635"><span id="local-6989586621679619636"><span class="annot"><span class="annottext">Bool
TestSpec
Day -&gt; Part -&gt; IO (Maybe String)
_mroInput :: Day -&gt; Part -&gt; IO (Maybe String)
_mroLock :: Bool
_mroBench :: Bool
_mroTest :: Bool
_mroActual :: Bool
_mroSpec :: TestSpec
_mroInput :: MainRunOpts -&gt; Day -&gt; Part -&gt; IO (Maybe String)
_mroLock :: MainRunOpts -&gt; Bool
_mroBench :: MainRunOpts -&gt; Bool
_mroTest :: MainRunOpts -&gt; Bool
_mroActual :: MainRunOpts -&gt; Bool
_mroSpec :: MainRunOpts -&gt; TestSpec
</span><a href="#local-6989586621679619631"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679619630"><span class="annot"><span class="annottext">ChallengeMap
</span><a href="#local-6989586621679619630"><span class="hs-identifier hs-var">toRun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either [String] ChallengeMap -&gt; m ChallengeMap
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><span class="hs-identifier hs-var">liftEither</span></span><span> </span><span class="annot"><span class="annottext">(Either [String] ChallengeMap -&gt; m ChallengeMap)
-&gt; (TestSpec -&gt; Either [String] ChallengeMap)
-&gt; TestSpec
-&gt; m ChallengeMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; Either String ChallengeMap -&gt; Either [String] ChallengeMap
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String ChallengeMap -&gt; Either [String] ChallengeMap)
-&gt; (TestSpec -&gt; Either String ChallengeMap)
-&gt; TestSpec
-&gt; Either [String] ChallengeMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestSpec -&gt; Either String ChallengeMap
</span><a href="AOC.Run.html#filterChallengeMap"><span class="hs-identifier hs-var">filterChallengeMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TestSpec -&gt; m ChallengeMap) -&gt; TestSpec -&gt; m ChallengeMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619636"><span class="hs-identifier hs-var">_mroSpec</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">IO (Map Day (Map Part (Maybe Bool, Either [String] String)))
-&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String)))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Map Day (Map Part (Maybe Bool, Either [String] String)))
 -&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String))))
-&gt; ((SomeSolution
     -&gt; Maybe String
     -&gt; ChallengeData
     -&gt; IO (Maybe Bool, Either [String] String))
    -&gt; IO (Map Day (Map Part (Maybe Bool, Either [String] String))))
-&gt; (SomeSolution
    -&gt; Maybe String
    -&gt; ChallengeData
    -&gt; IO (Maybe Bool, Either [String] String))
-&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; Integer
-&gt; Bool
-&gt; (Day -&gt; Part -&gt; IO (Maybe String))
-&gt; ChallengeMap
-&gt; (SomeSolution
    -&gt; Maybe String
    -&gt; ChallengeData
    -&gt; IO (Maybe Bool, Either [String] String))
-&gt; IO (Map Day (Map Part (Maybe Bool, Either [String] String)))
forall a.
Maybe String
-&gt; Integer
-&gt; Bool
-&gt; (Day -&gt; Part -&gt; IO (Maybe String))
-&gt; ChallengeMap
-&gt; (SomeSolution -&gt; Maybe String -&gt; ChallengeData -&gt; IO a)
-&gt; IO (Map Day (Map Part a))
</span><a href="AOC.Run.html#runAll"><span class="hs-identifier hs-var">runAll</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619640"><span class="hs-identifier hs-var">_cfgSession</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619639"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619632"><span class="hs-identifier hs-var">_mroLock</span></a></span><span> </span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; IO (Maybe String)
</span><a href="#local-6989586621679619631"><span class="hs-identifier hs-var">_mroInput</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="#local-6989586621679619630"><span class="hs-identifier hs-var">toRun</span></a></span><span> </span><span class="annot"><span class="annottext">((SomeSolution
  -&gt; Maybe String
  -&gt; ChallengeData
  -&gt; IO (Maybe Bool, Either [String] String))
 -&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String))))
-&gt; (SomeSolution
    -&gt; Maybe String
    -&gt; ChallengeData
    -&gt; IO (Maybe Bool, Either [String] String))
-&gt; m (Map Day (Map Part (Maybe Bool, Either [String] String)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679619625"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619625"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679619624"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619624"><span class="hs-identifier hs-var">inp0</span></a></span></span><span> </span><span id="local-6989586621679619623"><span class="annot"><span class="annottext">cd :: ChallengeData
</span><a href="#local-6989586621679619623"><span class="hs-identifier hs-var">cd</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AOC.Run.Load.html#CD"><span class="hs-identifier hs-type">CD</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619618"><span id="local-6989586621679619619"><span id="local-6989586621679619620"><span id="local-6989586621679619621"><span class="annot"><span class="annottext">[(String, TestMeta)]
Maybe String
Either [String] String
Either [String] Text
_cdTests :: ChallengeData -&gt; [(String, TestMeta)]
_cdAnswer :: ChallengeData -&gt; Maybe String
_cdInput :: ChallengeData -&gt; Either [String] String
_cdPrompt :: ChallengeData -&gt; Either [String] Text
_cdTests :: [(String, TestMeta)]
_cdAnswer :: Maybe String
_cdInput :: Either [String] String
_cdPrompt :: Either [String] Text
</span><a href="AOC.Run.Load.html#_cdTests"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>      </span><span id="local-6989586621679619613"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619613"><span class="hs-identifier hs-var">testRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe Bool) -&gt; Maybe Bool)
-&gt; IO (Maybe (Maybe Bool)) -&gt; IO (Maybe Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Bool) -&gt; Maybe Bool
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe (Maybe Bool)) -&gt; IO (Maybe Bool))
-&gt; ((() -&gt; IO (Maybe Bool)) -&gt; IO (Maybe (Maybe Bool)))
-&gt; (() -&gt; IO (Maybe Bool))
-&gt; IO (Maybe Bool)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; (() -&gt; IO (Maybe Bool)) -&gt; IO (Maybe (Maybe Bool))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619634"><span class="hs-identifier hs-var">_mroTest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((() -&gt; IO (Maybe Bool)) -&gt; IO (Maybe Bool))
-&gt; (() -&gt; IO (Maybe Bool)) -&gt; IO (Maybe Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">SomeSolution -&gt; ChallengeData -&gt; IO (Maybe Bool)
</span><a href="AOC.Run.html#runTestSuite"><span class="hs-identifier hs-var">runTestSuite</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619625"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeData
</span><a href="#local-6989586621679619623"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679619610"><span class="annot"><span class="annottext">inp1 :: Either [String] String
</span><a href="#local-6989586621679619610"><span class="hs-identifier hs-var hs-var">inp1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="AOC.Util.html#strip"><span class="hs-identifier hs-var">strip</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Either [String] String -&gt; Either [String] String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either [String] String
-&gt; (String -&gt; Either [String] String)
-&gt; Maybe String
-&gt; Either [String] String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Either [String] String
</span><a href="#local-6989586621679619620"><span class="hs-identifier hs-var">_cdInput</span></a></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Either [String] String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>           </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619624"><span class="hs-identifier hs-var">inp0</span></a></span><span>
</span><span id="line-148"></span><span>          </span><span id="local-6989586621679619607"><span class="annot"><span class="annottext">ans1 :: Maybe String
</span><a href="#local-6989586621679619607"><span class="hs-identifier hs-var hs-var">ans1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="AOC.Util.html#strip"><span class="hs-identifier hs-var">strip</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Maybe String -&gt; Maybe String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
-&gt; (String -&gt; Maybe String) -&gt; Maybe String -&gt; Maybe String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619619"><span class="hs-identifier hs-var">_cdAnswer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Maybe String
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619624"><span class="hs-identifier hs-var">inp0</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [String] String
</span><a href="#local-6989586621679619610"><span class="hs-identifier hs-var">inp1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679619605"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619605"><span class="hs-identifier hs-var">inp</span></a></span></span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619633"><span class="hs-identifier hs-var">_mroBench</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619605"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679619602"><span class="annot"><span class="annottext">res :: (Maybe Bool, Either [String] String)
</span><a href="#local-6989586621679619602"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619613"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either [String] String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran benchmark, so no result&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Bool, Either [String] String)
</span><a href="#local-6989586621679619602"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, Either [String] String)
-&gt; IO () -&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619625"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>                </span><span class="annot"><a href="AOC.Solver.html#MkSomeSolWH"><span class="hs-identifier hs-type">MkSomeSolWH</span></a></span><span> </span><span class="annot"><span class="annottext">a :~&gt; b
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>                      </span><span class="annot"><span class="annottext">Benchmarkable -&gt; IO ()
</span><span class="hs-identifier hs-var">benchmark</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Either SolutionError String) -&gt; String -&gt; Benchmarkable
forall b a. NFData b =&gt; (a -&gt; b) -&gt; a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">nf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeSolution -&gt; String -&gt; Either SolutionError String
</span><a href="AOC.Solver.html#runSomeSolution"><span class="hs-identifier hs-var">runSomeSolution</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619625"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619605"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                </span><span class="annot"><a href="AOC.Solver.html#MkSomeSolNF"><span class="hs-identifier hs-type">MkSomeSolNF</span></a></span><span> </span><span class="annot"><a href="AOC.Solver.html#MkSol"><span class="hs-identifier hs-type">MkSol</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619577"><span id="local-6989586621679619578"><span id="local-6989586621679619579"><span class="annot"><span class="annottext">b -&gt; String
(?dyno::DynoMap) =&gt; a -&gt; Maybe b
String -&gt; Maybe a
sShow :: forall a b. (a :~&gt; b) -&gt; b -&gt; String
sSolve :: forall a b. (a :~&gt; b) -&gt; (?dyno::DynoMap) =&gt; a -&gt; Maybe b
sParse :: forall a b. (a :~&gt; b) -&gt; String -&gt; Maybe a
sShow :: b -&gt; String
sSolve :: (?dyno::DynoMap) =&gt; a -&gt; Maybe b
sParse :: String -&gt; Maybe a
</span><a href="AOC.Solver.html#sShow"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679619573"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619573"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
</span><a href="#local-6989586621679619579"><span class="hs-identifier hs-var">sParse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619605"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>                      </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>                      </span><span class="annot"><span class="annottext">Benchmarkable -&gt; IO ()
</span><span class="hs-identifier hs-var">benchmark</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Maybe b) -&gt; a -&gt; Benchmarkable
forall b a. NFData b =&gt; (a -&gt; b) -&gt; a -&gt; Benchmarkable
</span><span class="hs-identifier hs-var">nf</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">let</span><span> </span><span class="">?dyno</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">?dyno::DynoMap
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
(?dyno::DynoMap) =&gt; a -&gt; Maybe b
</span><a href="#local-6989586621679619578"><span class="hs-identifier hs-var">sSolve</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;* parsing and formatting times excluded&quot;</span></span><span>
</span><span id="line-162"></span><span>                      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-163"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>                      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(No parse)&quot;</span></span><span>
</span><span id="line-165"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619635"><span class="hs-identifier hs-var">_mroActual</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either SolutionError String -&gt; Either [String] String)
-&gt; (Maybe Bool, Either SolutionError String)
-&gt; (Maybe Bool, Either [String] String)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Either SolutionError String -&gt; Either [String] String)
 -&gt; (Maybe Bool, Either SolutionError String)
 -&gt; (Maybe Bool, Either [String] String))
-&gt; ((SolutionError -&gt; [String])
    -&gt; Either SolutionError String -&gt; Either [String] String)
-&gt; (SolutionError -&gt; [String])
-&gt; (Maybe Bool, Either SolutionError String)
-&gt; (Maybe Bool, Either [String] String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SolutionError -&gt; [String])
-&gt; Either SolutionError String -&gt; Either [String] String
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (SolutionError -&gt; String) -&gt; SolutionError -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SolutionError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe Bool, Either SolutionError String)
 -&gt; (Maybe Bool, Either [String] String))
-&gt; IO (Maybe Bool, Either SolutionError String)
-&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; SomeSolution
-&gt; String
-&gt; TestMeta
-&gt; IO (Maybe Bool, Either SolutionError String)
</span><a href="AOC.Run.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619625"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619605"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Map String Dynamic -&gt; TestMeta
</span><a href="AOC.Run.Load.html#TM"><span class="hs-identifier hs-var">TM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619607"><span class="hs-identifier hs-var">ans1</span></a></span><span> </span><span class="annot"><span class="annottext">Map String Dynamic
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, Either [String] String)
-&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619613"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either [String] String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Actual input skipped&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679619564"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679619564"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619634"><span class="hs-identifier hs-var">_mroTest</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, Either [String] String)
-&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619613"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either [String] String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ran tests, so no result&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619613"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Either [String] String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679619564"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, Either [String] String)
-&gt; IO () -&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[INPUT ERROR]&quot;</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe Bool, Either [String] String)
-&gt; IO () -&gt; IO (Maybe Bool, Either [String] String)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; [String] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679619564"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | View prompt</span><span>
</span><span id="line-172"></span><span id="local-6989586621679620282"><span class="annot"><a href="AOC.Run.html#mainView"><span class="hs-identifier hs-type">mainView</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679620282"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679620282"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainViewOpts"><span class="hs-identifier hs-type">MainViewOpts</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679620282"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-177"></span><span id="mainView"><span class="annot"><span class="annottext">mainView :: forall (m :: * -&gt; *).
(MonadIO m, MonadError [String] m) =&gt;
Config -&gt; MainViewOpts -&gt; m (Map Day (Map Part Text))
</span><a href="AOC.Run.html#mainView"><span class="hs-identifier hs-var hs-var">mainView</span></a></span></span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Cfg"><span class="hs-identifier hs-type">Cfg</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619524"><span id="local-6989586621679619525"><span class="annot"><span class="annottext">Integer
Maybe String
_cfgYear :: Integer
_cfgSession :: Maybe String
_cfgYear :: Config -&gt; Integer
_cfgSession :: Config -&gt; Maybe String
</span><a href="#local-6989586621679619524"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="AOC.Run.html#MVO"><span class="hs-identifier hs-type">MVO</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619522"><span id="local-6989586621679619523"><span class="annot"><span class="annottext">Bool
TestSpec
_mvoWait :: Bool
_mvoSpec :: TestSpec
_mvoWait :: MainViewOpts -&gt; Bool
_mvoSpec :: MainViewOpts -&gt; TestSpec
</span><a href="#local-6989586621679619522"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679619521"><span class="annot"><span class="annottext">toRun :: Set (Day, Part)
</span><a href="#local-6989586621679619521"><span class="hs-identifier hs-var hs-var">toRun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (Day, Part)
-&gt; (ChallengeMap -&gt; Set (Day, Part))
-&gt; Maybe ChallengeMap
-&gt; Set (Day, Part)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Set (Day, Part)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Day, Part) SomeSolution -&gt; Set (Day, Part)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">M.keysSet</span></span><span> </span><span class="annot"><span class="annottext">(Map (Day, Part) SomeSolution -&gt; Set (Day, Part))
-&gt; (ChallengeMap -&gt; Map (Day, Part) SomeSolution)
-&gt; ChallengeMap
-&gt; Set (Day, Part)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChallengeMap -&gt; Map (Day, Part) SomeSolution
forall a b c. Map a (Map b c) -&gt; Map (a, b) c
</span><a href="AOC.Run.html#pullMap"><span class="hs-identifier hs-var">pullMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>              </span><span class="annot"><span class="annottext">(Maybe ChallengeMap -&gt; Set (Day, Part))
-&gt; (TestSpec -&gt; Maybe ChallengeMap) -&gt; TestSpec -&gt; Set (Day, Part)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either String ChallengeMap -&gt; Maybe ChallengeMap
forall (m :: * -&gt; *) e a. Alternative m =&gt; Either e a -&gt; m a
</span><a href="AOC.Util.html#eitherToMaybe"><span class="hs-identifier hs-var">eitherToMaybe</span></a></span><span>
</span><span id="line-180"></span><span>              </span><span class="annot"><span class="annottext">(Either String ChallengeMap -&gt; Maybe ChallengeMap)
-&gt; (TestSpec -&gt; Either String ChallengeMap)
-&gt; TestSpec
-&gt; Maybe ChallengeMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestSpec -&gt; Either String ChallengeMap
</span><a href="AOC.Run.html#filterChallengeMap"><span class="hs-identifier hs-var">filterChallengeMap</span></a></span><span>
</span><span id="line-181"></span><span>              </span><span class="annot"><span class="annottext">(TestSpec -&gt; Set (Day, Part)) -&gt; TestSpec -&gt; Set (Day, Part)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619523"><span class="hs-identifier hs-var">_mvoSpec</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span id="local-6989586621679619516"><span class="annot"><span class="annottext">allRun :: Set (Day, Part)
</span><a href="#local-6989586621679619516"><span class="hs-identifier hs-var hs-var">allRun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Day, Part) -&gt; Set (Day, Part))
-&gt; Maybe (Day, Part) -&gt; Set (Day, Part)
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">(Day, Part) -&gt; Set (Day, Part)
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Day, Part)
</span><a href="#local-6989586621679619513"><span class="hs-identifier hs-var">singleTest</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Day, Part) -&gt; Set (Day, Part) -&gt; Set (Day, Part)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Day, Part)
</span><a href="#local-6989586621679619521"><span class="hs-identifier hs-var">toRun</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">(Map (Day, Part) Text -&gt; Map Day (Map Part Text))
-&gt; m (Map (Day, Part) Text) -&gt; m (Map Day (Map Part Text))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Map (Day, Part) Text -&gt; Map Day (Map Part Text)
forall a b c. Eq a =&gt; Map (a, b) c -&gt; Map a (Map b c)
</span><a href="AOC.Run.html#pushMap"><span class="hs-identifier hs-var">pushMap</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Map (Day, Part) Text) -&gt; m (Map Day (Map Part Text)))
-&gt; (((Day, Part) -&gt; m Text) -&gt; m (Map (Day, Part) Text))
-&gt; ((Day, Part) -&gt; m Text)
-&gt; m (Map Day (Map Part Text))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (Day, Part) (m Text) -&gt; m (Map (Day, Part) Text)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">(Map (Day, Part) (m Text) -&gt; m (Map (Day, Part) Text))
-&gt; (((Day, Part) -&gt; m Text) -&gt; Map (Day, Part) (m Text))
-&gt; ((Day, Part) -&gt; m Text)
-&gt; m (Map (Day, Part) Text)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(((Day, Part) -&gt; m Text)
 -&gt; Set (Day, Part) -&gt; Map (Day, Part) (m Text))
-&gt; Set (Day, Part)
-&gt; ((Day, Part) -&gt; m Text)
-&gt; Map (Day, Part) (m Text)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Day, Part) -&gt; m Text)
-&gt; Set (Day, Part) -&gt; Map (Day, Part) (m Text)
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromSet</span></span><span> </span><span class="annot"><span class="annottext">Set (Day, Part)
</span><a href="#local-6989586621679619516"><span class="hs-identifier hs-var">allRun</span></a></span><span> </span><span class="annot"><span class="annottext">(((Day, Part) -&gt; m Text) -&gt; m (Map Day (Map Part Text)))
-&gt; ((Day, Part) -&gt; m Text) -&gt; m (Map Day (Map Part Text))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679619508"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619508"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679619507"><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619507"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>      </span><span id="local-6989586621679619506"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619506"><span class="hs-identifier hs-var">pmpt</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Day -&gt; m Text -&gt; m Text
</span><a href="#local-6989586621679619505"><span class="hs-identifier hs-var">waitFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619508"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(m Text -&gt; m Text) -&gt; m Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="AOC.Run.Load.html#CD"><span class="hs-identifier hs-type">CD</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619501"><span id="local-6989586621679619502"><span id="local-6989586621679619503"><span id="local-6989586621679619504"><span class="annot"><span class="annottext">[(String, TestMeta)]
Maybe String
Either [String] String
Either [String] Text
_cdTests :: [(String, TestMeta)]
_cdAnswer :: Maybe String
_cdInput :: Either [String] String
_cdPrompt :: Either [String] Text
_cdTests :: ChallengeData -&gt; [(String, TestMeta)]
_cdAnswer :: ChallengeData -&gt; Maybe String
_cdInput :: ChallengeData -&gt; Either [String] String
_cdPrompt :: ChallengeData -&gt; Either [String] Text
</span><a href="#local-6989586621679619501"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ChallengeData -&gt; m ChallengeData
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ChallengeData -&gt; m ChallengeData)
-&gt; IO ChallengeData -&gt; m ChallengeData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Integer -&gt; ChallengeSpec -&gt; IO ChallengeData
</span><a href="AOC.Run.Load.html#challengeData"><span class="hs-identifier hs-var">challengeData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619525"><span class="hs-identifier hs-var">_cfgSession</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619524"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; ChallengeSpec
</span><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-var">CS</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619508"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619507"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">Either [String] Text -&gt; m Text
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><span class="hs-identifier hs-var">liftEither</span></span><span> </span><span class="annot"><span class="annottext">(Either [String] Text -&gt; m Text)
-&gt; (Either [String] Text -&gt; Either [String] Text)
-&gt; Either [String] Text
-&gt; m Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; Either [String] Text -&gt; Either [String] Text
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[PROMPT ERROR]&quot;</span></span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either [String] Text -&gt; m Text) -&gt; Either [String] Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either [String] Text
</span><a href="#local-6989586621679619504"><span class="hs-identifier hs-var">_cdPrompt</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Dull</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Blue</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-189"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; Char -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&gt; Day %02d%c\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><span class="hs-identifier hs-var">dayInt</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619508"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Part -&gt; Char
</span><span class="hs-identifier hs-var">partChar</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619507"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.putStrLn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619506"><span class="hs-identifier hs-var">pmpt</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619506"><span class="hs-identifier hs-var">pmpt</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679619505"><span class="annot"><span class="annottext">waitFunc :: Day -&gt; m Text -&gt; m Text
</span><a href="#local-6989586621679619505"><span class="hs-identifier hs-var hs-var">waitFunc</span></a></span></span><span> </span><span id="local-6989586621679619496"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619496"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619522"><span class="hs-identifier hs-var">_mvoWait</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Day -&gt; m Text -&gt; m Text
forall (m :: * -&gt; *) a. MonadIO m =&gt; Integer -&gt; Day -&gt; m a -&gt; m a
</span><a href="AOC.Run.Load.html#countdownConsole"><span class="hs-identifier hs-var">countdownConsole</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619524"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619496"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">(m Text -&gt; m Text) -&gt; (m Text -&gt; m Text) -&gt; m Text -&gt; m Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">500000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; m Text -&gt; m Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Text -&gt; m Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679619513"><span class="annot"><span class="annottext">singleTest :: Maybe (Day, Part)
</span><a href="#local-6989586621679619513"><span class="hs-identifier hs-var hs-var">singleTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestSpec
</span><a href="#local-6989586621679619523"><span class="hs-identifier hs-var">_mvoSpec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="annottext">TestSpec
</span><a href="AOC.Run.html#TSAll"><span class="hs-identifier hs-var">TSAll</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Day, Part)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><a href="AOC.Run.html#TSDayAll"><span class="hs-identifier hs-type">TSDayAll</span></a></span><span> </span><span id="local-6989586621679619493"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619493"><span class="hs-identifier hs-var">d</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Day, Part) -&gt; Maybe (Day, Part)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619493"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Part
</span><span class="hs-identifier hs-var">Part1</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><a href="AOC.Run.html#TSDayPart"><span class="hs-identifier hs-type">TSDayPart</span></a></span><span> </span><span id="local-6989586621679619491"><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619491"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Day, Part) -&gt; Maybe (Day, Part)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChallengeSpec -&gt; Day
</span><a href="AOC.Discover.html#_csDay"><span class="hs-identifier hs-var hs-var">_csDay</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619491"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ChallengeSpec -&gt; Part
</span><a href="AOC.Discover.html#_csPart"><span class="hs-identifier hs-var hs-var">_csPart</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619491"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Submit and analyze result</span><span>
</span><span id="line-203"></span><span id="local-6989586621679620242"><span class="annot"><a href="AOC.Run.html#mainSubmit"><span class="hs-identifier hs-type">mainSubmit</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679620242"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679620242"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.html#MainSubmitOpts"><span class="hs-identifier hs-type">MainSubmitOpts</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679620242"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SubmitRes</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span id="mainSubmit"><span class="annot"><span class="annottext">mainSubmit :: forall (m :: * -&gt; *).
(MonadIO m, MonadError [String] m) =&gt;
Config -&gt; MainSubmitOpts -&gt; m (Text, SubmitRes)
</span><a href="AOC.Run.html#mainSubmit"><span class="hs-identifier hs-var hs-var">mainSubmit</span></a></span></span><span> </span><span class="annot"><a href="AOC.Run.Config.html#Cfg"><span class="hs-identifier hs-type">Cfg</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619401"><span id="local-6989586621679619402"><span class="annot"><span class="annottext">Integer
Maybe String
_cfgYear :: Integer
_cfgSession :: Maybe String
_cfgYear :: Config -&gt; Integer
_cfgSession :: Config -&gt; Maybe String
</span><a href="#local-6989586621679619401"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="AOC.Run.html#MSO"><span class="hs-identifier hs-type">MSO</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619396"><span id="local-6989586621679619397"><span id="local-6989586621679619398"><span id="local-6989586621679619399"><span id="local-6989586621679619400"><span class="annot"><span class="annottext">Bool
ChallengeSpec
_msoRetry :: Bool
_msoLock :: Bool
_msoForce :: Bool
_msoTest :: Bool
_msoSpec :: ChallengeSpec
_msoRetry :: MainSubmitOpts -&gt; Bool
_msoLock :: MainSubmitOpts -&gt; Bool
_msoForce :: MainSubmitOpts -&gt; Bool
_msoTest :: MainSubmitOpts -&gt; Bool
_msoSpec :: MainSubmitOpts -&gt; ChallengeSpec
</span><a href="#local-6989586621679619396"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679619395"><span class="annot"><span class="annottext">cd :: ChallengeData
</span><a href="#local-6989586621679619395"><span class="hs-identifier hs-var">cd</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AOC.Run.Load.html#CD"><span class="hs-identifier hs-type">CD</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619391"><span id="local-6989586621679619392"><span id="local-6989586621679619393"><span id="local-6989586621679619394"><span class="annot"><span class="annottext">[(String, TestMeta)]
Maybe String
Either [String] String
Either [String] Text
_cdTests :: [(String, TestMeta)]
_cdAnswer :: Maybe String
_cdInput :: Either [String] String
_cdPrompt :: Either [String] Text
_cdTests :: ChallengeData -&gt; [(String, TestMeta)]
_cdAnswer :: ChallengeData -&gt; Maybe String
_cdInput :: ChallengeData -&gt; Either [String] String
_cdPrompt :: ChallengeData -&gt; Either [String] Text
</span><a href="#local-6989586621679619391"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ChallengeData -&gt; m ChallengeData
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ChallengeData -&gt; m ChallengeData)
-&gt; IO ChallengeData -&gt; m ChallengeData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Integer -&gt; ChallengeSpec -&gt; IO ChallengeData
</span><a href="AOC.Run.Load.html#challengeData"><span class="hs-identifier hs-var">challengeData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619402"><span class="hs-identifier hs-var">_cfgSession</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619401"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619400"><span class="hs-identifier hs-var">_msoSpec</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span id="local-6989586621679619390"><span class="annot"><span class="annottext">Map Part SomeSolution
</span><a href="#local-6989586621679619390"><span class="hs-identifier hs-var">dMap</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String]
-&gt; Maybe (Map Part SomeSolution) -&gt; m (Map Part SomeSolution)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Day not yet available: %d&quot;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619389"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe (Map Part SomeSolution) -&gt; m (Map Part SomeSolution))
-&gt; Maybe (Map Part SomeSolution) -&gt; m (Map Part SomeSolution)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-211"></span><span>                   </span><span class="annot"><span class="annottext">Day -&gt; ChallengeMap -&gt; Maybe (Map Part SomeSolution)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619388"><span class="hs-identifier hs-var">_csDay</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="AOC.Challenge.html#challengeMap"><span class="hs-identifier hs-var">challengeMap</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679619387"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619387"><span class="hs-identifier hs-var">c</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe SomeSolution -&gt; m SomeSolution
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Part not found: %c&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Part -&gt; Char
</span><span class="hs-identifier hs-var">partChar</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619386"><span class="hs-identifier hs-var">_csPart</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe SomeSolution -&gt; m SomeSolution)
-&gt; Maybe SomeSolution -&gt; m SomeSolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-213"></span><span>                   </span><span class="annot"><span class="annottext">Part -&gt; Map Part SomeSolution -&gt; Maybe SomeSolution
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619386"><span class="hs-identifier hs-var">_csPart</span></a></span><span> </span><span class="annot"><span class="annottext">Map Part SomeSolution
</span><a href="#local-6989586621679619390"><span class="hs-identifier hs-var">dMap</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679619385"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619385"><span class="hs-identifier hs-var">inp</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either [String] String -&gt; m String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><span class="hs-identifier hs-var">liftEither</span></span><span> </span><span class="annot"><span class="annottext">(Either [String] String -&gt; m String)
-&gt; (Either [String] String -&gt; Either [String] String)
-&gt; Either [String] String
-&gt; m String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; Either [String] String -&gt; Either [String] String
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[PROMPT ERROR]&quot;</span></span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either [String] String -&gt; m String)
-&gt; Either [String] String -&gt; m String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either [String] String
</span><a href="#local-6989586621679619393"><span class="hs-identifier hs-var">_cdInput</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679619384"><span class="annot"><span class="annottext">AoCOpts
</span><a href="#local-6989586621679619384"><span class="hs-identifier hs-var">opts</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String -&gt; AoCOpts
</span><span class="hs-identifier hs-var">defaultAoCOpts</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619401"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; AoCOpts) -&gt; m String -&gt; m AoCOpts
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-216"></span><span>                    </span><span class="annot"><span class="annottext">[String] -&gt; Maybe String -&gt; m String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; Maybe a -&gt; m a
</span><a href="AOC.Util.html#maybeToEither"><span class="hs-identifier hs-var">maybeToEither</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ERROR: Session Key Required to Submit&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>                      </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619402"><span class="hs-identifier hs-var">_cfgSession</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619399"><span class="hs-identifier hs-var">_msoTest</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679619381"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619381"><span class="hs-identifier hs-var">testRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Bool) -&gt; m (Maybe Bool)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Bool) -&gt; m (Maybe Bool))
-&gt; IO (Maybe Bool) -&gt; m (Maybe Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeSolution -&gt; ChallengeData -&gt; IO (Maybe Bool)
</span><a href="AOC.Run.html#runTestSuite"><span class="hs-identifier hs-var">runTestSuite</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619387"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeData
</span><a href="#local-6989586621679619395"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619381"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619398"><span class="hs-identifier hs-var">_msoForce</span></a></span><span>
</span><span id="line-223"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Proceeding with submission despite test failures (--force)&quot;</span></span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>            </span><span id="local-6989586621679619378"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679619378"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Char) -&gt; m (Maybe Char)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Char) -&gt; m (Maybe Char))
-&gt; (InputT IO (Maybe Char) -&gt; IO (Maybe Char))
-&gt; InputT IO (Maybe Char)
-&gt; m (Maybe Char)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Settings IO -&gt; InputT IO (Maybe Char) -&gt; IO (Maybe Char)
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m) =&gt;
Settings m -&gt; InputT m a -&gt; m a
</span><span class="hs-identifier hs-var">H.runInputT</span></span><span> </span><span class="annot"><span class="annottext">Settings IO
forall (m :: * -&gt; *). MonadIO m =&gt; Settings m
</span><span class="hs-identifier hs-var">H.defaultSettings</span></span><span> </span><span class="annot"><span class="annottext">(InputT IO (Maybe Char) -&gt; m (Maybe Char))
-&gt; InputT IO (Maybe Char) -&gt; m (Maybe Char)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-226"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; InputT IO (Maybe Char)
forall (m :: * -&gt; *).
(MonadIO m, MonadMask m) =&gt;
String -&gt; InputT m (Maybe Char)
</span><span class="hs-identifier hs-var">H.getInputChar</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Some tests failed. Are you sure you wish to proceed? y/(n) &quot;</span></span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; Maybe Char -&gt; Maybe Char
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679619378"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-228"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'y'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>              </span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; m ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Submission aborted.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679619372"><span class="annot"><span class="annottext">Either SolutionError String
</span><a href="#local-6989586621679619372"><span class="hs-identifier hs-var">resEither</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either SolutionError String) -&gt; m (Either SolutionError String)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either SolutionError String)
 -&gt; m (Either SolutionError String))
-&gt; (String -&gt; IO (Either SolutionError String))
-&gt; String
-&gt; m (Either SolutionError String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either SolutionError String -&gt; IO (Either SolutionError String)
forall a. a -&gt; IO a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="annot"><span class="annottext">(Either SolutionError String -&gt; IO (Either SolutionError String))
-&gt; (String -&gt; Either SolutionError String)
-&gt; String
-&gt; IO (Either SolutionError String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either SolutionError String -&gt; Either SolutionError String
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">(Either SolutionError String -&gt; Either SolutionError String)
-&gt; (String -&gt; Either SolutionError String)
-&gt; String
-&gt; Either SolutionError String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SomeSolution -&gt; String -&gt; Either SolutionError String
</span><a href="AOC.Solver.html#runSomeSolution"><span class="hs-identifier hs-var">runSomeSolution</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619387"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m (Either SolutionError String))
-&gt; String -&gt; m (Either SolutionError String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619385"><span class="hs-identifier hs-var">inp</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679619371"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either [String] String -&gt; m String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><span class="hs-identifier hs-var">liftEither</span></span><span> </span><span class="annot"><span class="annottext">(Either [String] String -&gt; m String)
-&gt; (Either SolutionError String -&gt; Either [String] String)
-&gt; Either SolutionError String
-&gt; m String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SolutionError -&gt; [String])
-&gt; Either SolutionError String -&gt; Either [String] String
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[SOLUTION ERROR]&quot;</span></span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; (SolutionError -&gt; [String]) -&gt; SolutionError -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (SolutionError -&gt; String) -&gt; SolutionError -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SolutionError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either SolutionError String -&gt; m String)
-&gt; Either SolutionError String -&gt; m String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either SolutionError String
</span><a href="#local-6989586621679619372"><span class="hs-identifier hs-var">resEither</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Submitting solution: %s\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679619370"><span class="annot"><span class="annottext">submitter :: m (Either AoCError (Text, SubmitRes))
</span><a href="#local-6989586621679619370"><span class="hs-identifier hs-var hs-var">submitter</span></a></span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619396"><span class="hs-identifier hs-var">_msoRetry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AoCOpts
-&gt; Day -&gt; Part -&gt; String -&gt; m (Either AoCError (Text, SubmitRes))
forall (m :: * -&gt; *).
MonadIO m =&gt;
AoCOpts
-&gt; Day -&gt; Part -&gt; String -&gt; m (Either AoCError (Text, SubmitRes))
</span><a href="AOC.Run.html#submitRetry"><span class="hs-identifier hs-var">submitRetry</span></a></span><span> </span><span class="annot"><span class="annottext">AoCOpts
</span><a href="#local-6989586621679619384"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619388"><span class="hs-identifier hs-var">_csDay</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619386"><span class="hs-identifier hs-var">_csPart</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Either AoCError (Text, SubmitRes))
-&gt; m (Either AoCError (Text, SubmitRes))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either AoCError (Text, SubmitRes))
 -&gt; m (Either AoCError (Text, SubmitRes)))
-&gt; IO (Either AoCError (Text, SubmitRes))
-&gt; m (Either AoCError (Text, SubmitRes))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AoCOpts
-&gt; AoC (Text, SubmitRes) -&gt; IO (Either AoCError (Text, SubmitRes))
forall a. AoCOpts -&gt; AoC a -&gt; IO (Either AoCError a)
</span><span class="hs-identifier hs-var">runAoC</span></span><span> </span><span class="annot"><span class="annottext">AoCOpts
</span><a href="#local-6989586621679619384"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; String -&gt; AoC (Text, SubmitRes)
</span><span class="hs-identifier hs-var">AoCSubmit</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619388"><span class="hs-identifier hs-var">_csDay</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619386"><span class="hs-identifier hs-var">_csPart</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679619366"><span class="annot"><span class="annottext">output :: (Text, SubmitRes)
</span><a href="#local-6989586621679619366"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679619365"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619365"><span class="hs-identifier hs-var">resp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619364"><span class="annot"><span class="annottext">SubmitRes
</span><a href="#local-6989586621679619364"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either [String] (Text, SubmitRes) -&gt; m (Text, SubmitRes)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; Either e a -&gt; m a
</span><span class="hs-identifier hs-var">liftEither</span></span><span> </span><span class="annot"><span class="annottext">(Either [String] (Text, SubmitRes) -&gt; m (Text, SubmitRes))
-&gt; (Either AoCError (Text, SubmitRes)
    -&gt; Either [String] (Text, SubmitRes))
-&gt; Either AoCError (Text, SubmitRes)
-&gt; m (Text, SubmitRes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AoCError -&gt; [String])
-&gt; Either AoCError (Text, SubmitRes)
-&gt; Either [String] (Text, SubmitRes)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">AoCError -&gt; [String]
</span><a href="AOC.Run.Load.html#showAoCError"><span class="hs-identifier hs-var">showAoCError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either AoCError (Text, SubmitRes) -&gt; m (Text, SubmitRes))
-&gt; m (Either AoCError (Text, SubmitRes)) -&gt; m (Text, SubmitRes)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m (Either AoCError (Text, SubmitRes))
</span><a href="#local-6989586621679619370"><span class="hs-identifier hs-var">submitter</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679619361"><span class="annot"><span class="annottext">resp' :: String
</span><a href="#local-6989586621679619361"><span class="hs-identifier hs-var hs-var">resp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; String
</span><a href="#local-6989586621679619360"><span class="hs-identifier hs-var">formatResp</span></a></span><span>
</span><span id="line-240"></span><span>              </span><span class="annot"><span class="annottext">([Text] -&gt; String) -&gt; (Text -&gt; [Text]) -&gt; Text -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [Text])
-&gt; (Text -&gt; [Text]) -&gt; Either [String] Text -&gt; [Text]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; [String] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.lines</span></span><span>
</span><span id="line-241"></span><span>              </span><span class="annot"><span class="annottext">(Either [String] Text -&gt; [Text])
-&gt; (Text -&gt; Either [String] Text) -&gt; Text -&gt; [Text]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; Either [String] Text
</span><a href="AOC.Run.Load.html#htmlToMarkdown"><span class="hs-identifier hs-var">htmlToMarkdown</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-242"></span><span>              </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619365"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679619355"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619355"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619354"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619354"><span class="hs-identifier hs-var">lock</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619353"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619353"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SubmitRes -&gt; (Color, Bool, String)
</span><a href="AOC.Run.html#displayStatus"><span class="hs-identifier hs-var">displayStatus</span></a></span><span> </span><span class="annot"><span class="annottext">SubmitRes
</span><a href="#local-6989586621679619364"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Vivid</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619355"><span class="hs-identifier hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619353"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619361"><span class="hs-identifier hs-var">resp'</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619354"><span class="hs-identifier hs-var">lock</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-249"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619397"><span class="hs-identifier hs-var">_msoLock</span></a></span><span>
</span><span id="line-250"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Locking correct answer.&quot;</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619349"><span class="hs-identifier hs-var">_cpAnswer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Not locking correct answer (--no-lock)&quot;</span></span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679619348"><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679619348"><span class="hs-identifier hs-var">zt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ZonedTime
</span><span class="hs-identifier hs-var">getZonedTime</span></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">appendFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619345"><span class="hs-identifier hs-var">_cpLog</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String -&gt; Text -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619344"><span class="hs-identifier hs-var">logFmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZonedTime -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679619348"><span class="hs-identifier hs-var">zt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619371"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubmitRes -&gt; String
</span><span class="hs-identifier hs-var">showSubmitRes</span></span><span> </span><span class="annot"><span class="annottext">SubmitRes
</span><a href="#local-6989586621679619364"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619365"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619361"><span class="hs-identifier hs-var">resp'</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="annot"><span class="annottext">(Text, SubmitRes)
</span><a href="#local-6989586621679619366"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-type">CS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619386"><span id="local-6989586621679619388"><span class="annot"><span class="annottext">Day
Part
_csPart :: Part
_csDay :: Day
_csPart :: ChallengeSpec -&gt; Part
_csDay :: ChallengeSpec -&gt; Day
</span><a href="#local-6989586621679619386"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619400"><span class="hs-identifier hs-var">_msoSpec</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="AOC.Run.Load.html#CP"><span class="hs-identifier hs-type">CP</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619339"><span id="local-6989586621679619340"><span id="local-6989586621679619341"><span id="local-6989586621679619345"><span id="local-6989586621679619349"><span class="annot"><span class="annottext">String
_cpLog :: ChallengePaths -&gt; String
_cpTests :: ChallengePaths -&gt; String
_cpAnswer :: ChallengePaths -&gt; String
_cpInput :: ChallengePaths -&gt; String
_cpPrompt :: ChallengePaths -&gt; String
_cpTests :: String
_cpInput :: String
_cpPrompt :: String
_cpLog :: String
_cpAnswer :: String
</span><a href="AOC.Run.Load.html#_cpLog"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ChallengeSpec -&gt; ChallengePaths
</span><a href="AOC.Run.Load.html#challengePaths"><span class="hs-identifier hs-var">challengePaths</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619401"><span class="hs-identifier hs-var">_cfgYear</span></a></span><span> </span><span class="annot"><span class="annottext">ChallengeSpec
</span><a href="#local-6989586621679619400"><span class="hs-identifier hs-var">_msoSpec</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679619389"><span class="annot"><span class="annottext">d' :: Integer
</span><a href="#local-6989586621679619389"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><span class="hs-identifier hs-var">dayInt</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619388"><span class="hs-identifier hs-var">_csDay</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679619360"><span class="annot"><span class="annottext">formatResp :: [Text] -&gt; String
</span><a href="#local-6989586621679619360"><span class="hs-identifier hs-var hs-var">formatResp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; ([Text] -&gt; Text) -&gt; [Text] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; ([Text] -&gt; [Text]) -&gt; [Text] -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679619344"><span class="annot"><span class="annottext">logFmt :: String
</span><a href="#local-6989586621679619344"><span class="hs-identifier hs-var hs-var">logFmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[%s]&quot;</span></span><span>
</span><span id="line-261"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Submission: %s&quot;</span></span><span>
</span><span id="line-262"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Status: %s&quot;</span></span><span>
</span><span id="line-263"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Raw: %s&quot;</span></span><span>
</span><span id="line-264"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%s&quot;</span></span><span>
</span><span id="line-265"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679620224"><span class="annot"><a href="AOC.Run.html#submitRetry"><span class="hs-identifier hs-type">submitRetry</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679620224"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AoCOpts</span></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679620224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AoCError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SubmitRes</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-274"></span><span id="submitRetry"><span class="annot"><span class="annottext">submitRetry :: forall (m :: * -&gt; *).
MonadIO m =&gt;
AoCOpts
-&gt; Day -&gt; Part -&gt; String -&gt; m (Either AoCError (Text, SubmitRes))
</span><a href="AOC.Run.html#submitRetry"><span class="hs-identifier hs-var hs-var">submitRetry</span></a></span></span><span> </span><span id="local-6989586621679619295"><span class="annot"><span class="annottext">AoCOpts
</span><a href="#local-6989586621679619295"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679619294"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619294"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679619293"><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619293"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679619292"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619292"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT AoCError m (Text, SubmitRes)
-&gt; m (Either AoCError (Text, SubmitRes))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">ExceptT AoCError m (Text, SubmitRes)
</span><a href="#local-6989586621679619290"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679619290"><span class="annot"><span class="annottext">go :: ExceptT AoCError m (Text, SubmitRes)
</span><a href="#local-6989586621679619290"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621679619289"><span class="annot"><span class="annottext">out :: (Text, SubmitRes)
</span><a href="#local-6989586621679619289"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619288"><span class="annot"><span class="annottext">SubmitRes
</span><a href="#local-6989586621679619288"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either AoCError (Text, SubmitRes))
-&gt; ExceptT AoCError m (Text, SubmitRes)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">(m (Either AoCError (Text, SubmitRes))
 -&gt; ExceptT AoCError m (Text, SubmitRes))
-&gt; (IO (Either AoCError (Text, SubmitRes))
    -&gt; m (Either AoCError (Text, SubmitRes)))
-&gt; IO (Either AoCError (Text, SubmitRes))
-&gt; ExceptT AoCError m (Text, SubmitRes)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Either AoCError (Text, SubmitRes))
-&gt; m (Either AoCError (Text, SubmitRes))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either AoCError (Text, SubmitRes))
 -&gt; ExceptT AoCError m (Text, SubmitRes))
-&gt; IO (Either AoCError (Text, SubmitRes))
-&gt; ExceptT AoCError m (Text, SubmitRes)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AoCOpts
-&gt; AoC (Text, SubmitRes) -&gt; IO (Either AoCError (Text, SubmitRes))
forall a. AoCOpts -&gt; AoC a -&gt; IO (Either AoCError a)
</span><span class="hs-identifier hs-var">runAoC</span></span><span> </span><span class="annot"><span class="annottext">AoCOpts
</span><a href="#local-6989586621679619295"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; String -&gt; AoC (Text, SubmitRes)
</span><span class="hs-identifier hs-var">AoCSubmit</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619294"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619293"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619292"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SubmitRes
</span><a href="#local-6989586621679619288"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">SubWait</span></span><span> </span><span id="local-6989586621679619285"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619285"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT AoCError m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT AoCError m ())
-&gt; (IO () -&gt; IO ()) -&gt; IO () -&gt; ExceptT AoCError m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Vivid</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Yellow</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT AoCError m ()) -&gt; IO () -&gt; ExceptT AoCError m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-281"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Automatically waiting %d seconds to re-submit...\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619285"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-282"></span><span>          </span><span class="hs-comment">-- 0.1 to account for latency</span><span>
</span><span id="line-283"></span><span>          </span><span id="local-6989586621679619283"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679619283"><span class="hs-identifier hs-var">resubTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pico -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">secondsToNominalDiffTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Pico
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619285"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Pico -&gt; Pico -&gt; Pico
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Pico
</span><span class="hs-number">0.1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; UTCTime)
-&gt; ExceptT AoCError m UTCTime -&gt; ExceptT AoCError m UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; ExceptT AoCError m UTCTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">ExceptT AoCError m NominalDiffTime
-&gt; Int
-&gt; String
-&gt; ExceptT AoCError m (Text, SubmitRes)
-&gt; ExceptT AoCError m (Text, SubmitRes)
forall (m :: * -&gt; *) a.
MonadIO m =&gt;
m NominalDiffTime -&gt; Int -&gt; String -&gt; m a -&gt; m a
</span><a href="AOC.Run.Load.html#countdownWithPrint"><span class="hs-identifier hs-var">countdownWithPrint</span></a></span><span>
</span><span id="line-285"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679619283"><span class="hs-identifier hs-var">resubTime</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-operator hs-var">`diffUTCTime`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; NominalDiffTime)
-&gt; ExceptT AoCError m UTCTime -&gt; ExceptT AoCError m NominalDiffTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; ExceptT AoCError m UTCTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100000</span></span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Re-submit&quot;</span></span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">ExceptT AoCError m (Text, SubmitRes)
</span><a href="#local-6989586621679619290"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">SubmitRes
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Text, SubmitRes) -&gt; ExceptT AoCError m (Text, SubmitRes)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text, SubmitRes)
</span><a href="#local-6989586621679619289"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="AOC.Run.html#displayStatus"><span class="hs-identifier hs-type">displayStatus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SubmitRes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ANSI.Color</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="displayStatus"><span class="annot"><span class="annottext">displayStatus :: SubmitRes -&gt; (Color, Bool, String)
</span><a href="AOC.Run.html#displayStatus"><span class="hs-identifier hs-var hs-var">displayStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubCorrect</span></span><span> </span><span id="local-6989586621679619276"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679619276"><span class="hs-identifier hs-var">r</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Green</span></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Integer -&gt; String
forall {p} {t}.
(IsString p, PrintfArg t, PrintfType p) =&gt;
Maybe t -&gt; p
</span><a href="#local-6989586621679619274"><span class="hs-identifier hs-var">correctMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679619276"><span class="hs-identifier hs-var">r</span></a></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubIncorrect</span></span><span> </span><span id="local-6989586621679619272"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619272"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679619271"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619271"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Red</span></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe String -&gt; String
forall {t} {t} {t}.
(PrintfArg t, PrintfArg t, PrintfType t, Integral t) =&gt;
t -&gt; Maybe t -&gt; t
</span><a href="#local-6989586621679619269"><span class="hs-identifier hs-var">incorrectMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619272"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619271"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubWait</span></span><span> </span><span id="local-6989586621679619268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619268"><span class="hs-identifier hs-var">t</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679619267"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619267"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619266"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619266"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619268"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60</span></span><span>
</span><span id="line-296"></span><span>                            </span><span id="local-6989586621679619264"><span class="annot"><span class="annottext">resp :: String
</span><a href="#local-6989586621679619264"><span class="hs-identifier hs-var hs-var">resp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Answer re-submitted too soon.  Please wait %dmin %dsec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619267"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619266"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-297"></span><span>                        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Yellow</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619264"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubInvalid</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Blue</span></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-299"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Submission was rejected.  Maybe not unlocked yet, or already answered?&quot;</span></span><span>
</span><span id="line-300"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubUnknown</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Magenta</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-302"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response from server was not recognized.&quot;</span></span><span>
</span><span id="line-303"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679619274"><span class="annot"><span class="annottext">correctMsg :: Maybe t -&gt; p
</span><a href="#local-6989586621679619274"><span class="hs-identifier hs-var hs-var">correctMsg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-string">&quot;Answer was correct!&quot;</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621679619274"><span class="hs-identifier hs-var">correctMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679619255"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619255"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; t -&gt; p
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Answer was correct, and you made the global leaderboard at rank %d !!&quot;</span></span><span>
</span><span id="line-308"></span><span>          </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619255"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679619269"><span class="annot"><span class="annottext">incorrectMsg :: t -&gt; Maybe t -&gt; t
</span><a href="#local-6989586621679619269"><span class="hs-identifier hs-var hs-var">incorrectMsg</span></a></span></span><span> </span><span id="local-6989586621679619241"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619241"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679619240"><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679619240"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; t -&gt; t
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Answer was incorrect!%s  Please wait %d before submitting again&quot;</span></span><span>
</span><span id="line-311"></span><span>          </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619239"><span class="hs-identifier hs-var">hintStr</span></a></span><span>
</span><span id="line-312"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619241"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><a href="#local-6989586621679619239"><span class="hs-identifier hs-type">hintStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621679619239"><span class="annot"><span class="annottext">hintStr :: String
</span><a href="#local-6989586621679619239"><span class="hs-identifier hs-var hs-var">hintStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe t
</span><a href="#local-6989586621679619240"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>          </span><span class="annot"><span class="annottext">Maybe t
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-317"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679619237"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619237"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; t -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Hint: Answer was %s.&quot;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619237"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621679620329"><span class="annot"><a href="AOC.Run.html#runAll"><span class="hs-identifier hs-type">runAll</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                         </span><span class="hs-comment">-- ^ session key</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>                              </span><span class="hs-comment">-- ^ year</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                                 </span><span class="hs-comment">-- ^ run and lock answer</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ replacements</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Discover.html#ChallengeMap"><span class="hs-identifier hs-type">ChallengeMap</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AOC.Solver.html#SomeSolution"><span class="hs-identifier hs-type">SomeSolution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Load.html#ChallengeData"><span class="hs-identifier hs-type">ChallengeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679620329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ callback. given solution, &quot;replacement&quot; input, and data</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Part</span></span><span> </span><span class="annot"><a href="#local-6989586621679620329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-327"></span><span id="runAll"><span class="annot"><span class="annottext">runAll :: forall a.
Maybe String
-&gt; Integer
-&gt; Bool
-&gt; (Day -&gt; Part -&gt; IO (Maybe String))
-&gt; ChallengeMap
-&gt; (SomeSolution -&gt; Maybe String -&gt; ChallengeData -&gt; IO a)
-&gt; IO (Map Day (Map Part a))
</span><a href="AOC.Run.html#runAll"><span class="hs-identifier hs-var hs-var">runAll</span></a></span></span><span> </span><span id="local-6989586621679619214"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619214"><span class="hs-identifier hs-var">sess</span></a></span></span><span> </span><span id="local-6989586621679619213"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619213"><span class="hs-identifier hs-var">yr</span></a></span></span><span> </span><span id="local-6989586621679619212"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619212"><span class="hs-identifier hs-var">lock</span></a></span></span><span> </span><span id="local-6989586621679619211"><span class="annot"><span class="annottext">Day -&gt; Part -&gt; IO (Maybe String)
</span><a href="#local-6989586621679619211"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621679619210"><span class="annot"><span class="annottext">ChallengeMap
</span><a href="#local-6989586621679619210"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span id="local-6989586621679619209"><span class="annot"><span class="annottext">SomeSolution -&gt; Maybe String -&gt; ChallengeData -&gt; IO a
</span><a href="#local-6989586621679619209"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Day -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
 -&gt; ChallengeMap -&gt; IO (Map Day (Map Part a)))
-&gt; ChallengeMap
-&gt; (Day -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
-&gt; IO (Map Day (Map Part a))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Day -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
-&gt; ChallengeMap -&gt; IO (Map Day (Map Part a))
forall (t :: * -&gt; *) k a b.
Applicative t =&gt;
(k -&gt; a -&gt; t b) -&gt; Map k a -&gt; t (Map k b)
</span><span class="hs-identifier hs-var">M.traverseWithKey</span></span><span> </span><span class="annot"><span class="annottext">ChallengeMap
</span><a href="#local-6989586621679619210"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">((Day -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
 -&gt; IO (Map Day (Map Part a)))
-&gt; (Day -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
-&gt; IO (Map Day (Map Part a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679619207"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>                               </span><span class="annot"><span class="annottext">(Part -&gt; SomeSolution -&gt; IO a)
-&gt; Map Part SomeSolution -&gt; IO (Map Part a)
forall (t :: * -&gt; *) k a b.
Applicative t =&gt;
(k -&gt; a -&gt; t b) -&gt; Map k a -&gt; t (Map k b)
</span><span class="hs-identifier hs-var">M.traverseWithKey</span></span><span> </span><span class="annot"><span class="annottext">((Part -&gt; SomeSolution -&gt; IO a)
 -&gt; Map Part SomeSolution -&gt; IO (Map Part a))
-&gt; (Part -&gt; SomeSolution -&gt; IO a)
-&gt; Map Part SomeSolution
-&gt; IO (Map Part a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679619206"><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679619205"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619205"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="AOC.Run.Load.html#CP"><span class="hs-identifier hs-type">CP</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619200"><span id="local-6989586621679619201"><span id="local-6989586621679619202"><span id="local-6989586621679619203"><span id="local-6989586621679619204"><span class="annot"><span class="annottext">String
_cpLog :: String
_cpTests :: String
_cpAnswer :: String
_cpInput :: String
_cpPrompt :: String
_cpLog :: ChallengePaths -&gt; String
_cpTests :: ChallengePaths -&gt; String
_cpAnswer :: ChallengePaths -&gt; String
_cpInput :: ChallengePaths -&gt; String
_cpPrompt :: ChallengePaths -&gt; String
</span><a href="#local-6989586621679619200"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ChallengeSpec -&gt; ChallengePaths
</span><a href="AOC.Run.Load.html#challengePaths"><span class="hs-identifier hs-var">challengePaths</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619213"><span class="hs-identifier hs-var">yr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; ChallengeSpec
</span><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-var">CS</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679619199"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619199"><span class="hs-identifier hs-var">inp0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; IO (Maybe String)
</span><a href="#local-6989586621679619211"><span class="hs-identifier hs-var">rep</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Dull</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Blue</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Integer -&gt; Char -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&gt; Day %02d%c\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Integer
</span><span class="hs-identifier hs-var">dayInt</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Part -&gt; Char
</span><span class="hs-identifier hs-var">partChar</span></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619212"><span class="hs-identifier hs-var">lock</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><a href="AOC.Run.Load.html#CD"><span class="hs-identifier hs-type">CD</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619195"><span id="local-6989586621679619196"><span id="local-6989586621679619197"><span id="local-6989586621679619198"><span class="annot"><span class="annottext">[(String, TestMeta)]
Maybe String
Either [String] String
Either [String] Text
_cdTests :: [(String, TestMeta)]
_cdAnswer :: Maybe String
_cdInput :: Either [String] String
_cdPrompt :: Either [String] Text
_cdTests :: ChallengeData -&gt; [(String, TestMeta)]
_cdAnswer :: ChallengeData -&gt; Maybe String
_cdInput :: ChallengeData -&gt; Either [String] String
_cdPrompt :: ChallengeData -&gt; Either [String] Text
</span><a href="#local-6989586621679619195"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Integer -&gt; ChallengeSpec -&gt; IO ChallengeData
</span><a href="AOC.Run.Load.html#challengeData"><span class="hs-identifier hs-var">challengeData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619214"><span class="hs-identifier hs-var">sess</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619213"><span class="hs-identifier hs-var">yr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; ChallengeSpec
</span><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-var">CS</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="annottext">Maybe String -&gt; (String -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619199"><span class="hs-identifier hs-var">inp0</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Maybe String -&gt; Maybe String
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either [String] String -&gt; Maybe String
forall (m :: * -&gt; *) e a. Alternative m =&gt; Either e a -&gt; m a
</span><a href="AOC.Util.html#eitherToMaybe"><span class="hs-identifier hs-var">eitherToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Either [String] String
</span><a href="#local-6989586621679619197"><span class="hs-identifier hs-var">_cdInput</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; IO ()) -&gt; (String -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679619192"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619192"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Either SolutionError String -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619202"><span class="hs-identifier hs-var">_cpAnswer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either SolutionError String -&gt; IO ())
-&gt; IO (Either SolutionError String) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Either SolutionError String -&gt; IO (Either SolutionError String)
forall a. a -&gt; IO a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either SolutionError String -&gt; Either SolutionError String
forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeSolution -&gt; String -&gt; Either SolutionError String
</span><a href="AOC.Solver.html#runSomeSolution"><span class="hs-identifier hs-var">runSomeSolution</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619205"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619192"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="annottext">SomeSolution -&gt; Maybe String -&gt; ChallengeData -&gt; IO a
</span><a href="#local-6989586621679619209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619205"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619199"><span class="hs-identifier hs-var">inp0</span></a></span><span> </span><span class="annot"><span class="annottext">(ChallengeData -&gt; IO a) -&gt; IO ChallengeData -&gt; IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Integer -&gt; ChallengeSpec -&gt; IO ChallengeData
</span><a href="AOC.Run.Load.html#challengeData"><span class="hs-identifier hs-var">challengeData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619214"><span class="hs-identifier hs-var">sess</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679619213"><span class="hs-identifier hs-var">yr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; Part -&gt; ChallengeSpec
</span><a href="AOC.Discover.html#CS"><span class="hs-identifier hs-var">CS</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679619207"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Part
</span><a href="#local-6989586621679619206"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="AOC.Run.html#runTestSuite"><span class="hs-identifier hs-type">runTestSuite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AOC.Solver.html#SomeSolution"><span class="hs-identifier hs-type">SomeSolution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Load.html#ChallengeData"><span class="hs-identifier hs-type">ChallengeData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span id="runTestSuite"><span class="annot"><span class="annottext">runTestSuite :: SomeSolution -&gt; ChallengeData -&gt; IO (Maybe Bool)
</span><a href="AOC.Run.html#runTestSuite"><span class="hs-identifier hs-var hs-var">runTestSuite</span></a></span></span><span> </span><span id="local-6989586621679619191"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619191"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="AOC.Run.Load.html#CD"><span class="hs-identifier hs-type">CD</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619187"><span id="local-6989586621679619188"><span id="local-6989586621679619189"><span id="local-6989586621679619190"><span class="annot"><span class="annottext">[(String, TestMeta)]
Maybe String
Either [String] String
Either [String] Text
_cdTests :: [(String, TestMeta)]
_cdAnswer :: Maybe String
_cdInput :: Either [String] String
_cdPrompt :: Either [String] Text
_cdTests :: ChallengeData -&gt; [(String, TestMeta)]
_cdAnswer :: ChallengeData -&gt; Maybe String
_cdInput :: ChallengeData -&gt; Either [String] String
_cdPrompt :: ChallengeData -&gt; Either [String] Text
</span><a href="#local-6989586621679619187"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679619186"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Maybe Bool, Either SolutionError String) -&gt; Maybe Bool)
-&gt; [(Maybe Bool, Either SolutionError String)] -&gt; [Bool]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool, Either SolutionError String) -&gt; Maybe Bool
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Maybe Bool, Either SolutionError String)] -&gt; [Bool])
-&gt; IO [(Maybe Bool, Either SolutionError String)] -&gt; IO [Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((String, TestMeta)
 -&gt; IO (Maybe Bool, Either SolutionError String))
-&gt; [(String, TestMeta)]
-&gt; IO [(Maybe Bool, Either SolutionError String)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String
 -&gt; TestMeta -&gt; IO (Maybe Bool, Either SolutionError String))
-&gt; (String, TestMeta)
-&gt; IO (Maybe Bool, Either SolutionError String)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
-&gt; SomeSolution
-&gt; String
-&gt; TestMeta
-&gt; IO (Maybe Bool, Either SolutionError String)
</span><a href="AOC.Run.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619191"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, TestMeta)]
</span><a href="#local-6989586621679619187"><span class="hs-identifier hs-var">_cdTests</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679619181"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679619181"><span class="hs-identifier hs-var">mark</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619180"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619180"><span class="hs-identifier hs-var">color</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#10003;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Green</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#10007;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Red</span></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Vivid</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619180"><span class="hs-identifier hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Int -&gt; Int -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[%c] Passed %d out of %d test(s)\n&quot;</span></span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679619181"><span class="hs-identifier hs-var">mark</span></a></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; [Bool] -&gt; [Bool]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe () -&gt; Maybe Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679619186"><span class="hs-identifier hs-var">testRes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Run a single test case</span><span>
</span><span id="line-355"></span><span class="annot"><a href="AOC.Run.html#testCase"><span class="hs-identifier hs-type">testCase</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>             </span><span class="hs-comment">-- ^ is just an example</span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Solver.html#SomeSolution"><span class="hs-identifier hs-type">SomeSolution</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AOC.Run.Load.html#TestMeta"><span class="hs-identifier hs-type">TestMeta</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AOC.Solver.html#SolutionError"><span class="hs-identifier hs-type">SolutionError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span id="testCase"><span class="annot"><span class="annottext">testCase :: Bool
-&gt; SomeSolution
-&gt; String
-&gt; TestMeta
-&gt; IO (Maybe Bool, Either SolutionError String)
</span><a href="AOC.Run.html#testCase"><span class="hs-identifier hs-var hs-var">testCase</span></a></span></span><span> </span><span id="local-6989586621679619177"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619177"><span class="hs-identifier hs-var">emph</span></a></span></span><span> </span><span id="local-6989586621679619176"><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619176"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679619175"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619175"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="annot"><a href="AOC.Run.Load.html#TM"><span class="hs-identifier hs-type">TM</span></a></span><span class="hs-special">{</span><span id="local-6989586621679619173"><span id="local-6989586621679619174"><span class="annot"><span class="annottext">Maybe String
Map String Dynamic
_tmData :: TestMeta -&gt; Map String Dynamic
_tmAnswer :: TestMeta -&gt; Maybe String
_tmData :: Map String Dynamic
_tmAnswer :: Maybe String
</span><a href="AOC.Run.Load.html#_tmData"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Dull</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619170"><span class="hs-identifier hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[%c]&quot;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679619169"><span class="hs-identifier hs-var">mark</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679619177"><span class="hs-identifier hs-var">emph</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (%s)\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619168"><span class="hs-identifier hs-var">resStr</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; %s\n&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619168"><span class="hs-identifier hs-var">resStr</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">Maybe String -&gt; (String -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619167"><span class="hs-identifier hs-var">showAns</span></a></span><span> </span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; IO ()) -&gt; (String -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679619166"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619166"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var">withColor</span></a></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><span class="hs-identifier hs-var">ANSI.Vivid</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Red</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Expected: %s)\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619166"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619165"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either SolutionError String
</span><a href="#local-6989586621679619164"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621679619164"><span class="annot"><span class="annottext">res :: Either SolutionError String
</span><a href="#local-6989586621679619164"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map String Dynamic
-&gt; SomeSolution -&gt; String -&gt; Either SolutionError String
</span><a href="AOC.Solver.html#runSomeSolutionWith"><span class="hs-identifier hs-var">runSomeSolutionWith</span></a></span><span> </span><span class="annot"><span class="annottext">Map String Dynamic
</span><a href="#local-6989586621679619173"><span class="hs-identifier hs-var">_tmData</span></a></span><span> </span><span class="annot"><span class="annottext">SomeSolution
</span><a href="#local-6989586621679619176"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619175"><span class="hs-identifier hs-var">inp</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679619168"><span class="annot"><span class="annottext">resStr :: String
</span><a href="#local-6989586621679619168"><span class="hs-identifier hs-var hs-var">resStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SolutionError String
</span><a href="#local-6989586621679619164"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679619162"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619162"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619162"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">SolutionError
</span><a href="AOC.Solver.html#SEParse"><span class="hs-identifier hs-var">SEParse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ERROR: No parse&quot;</span></span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">SolutionError
</span><a href="AOC.Solver.html#SESolve"><span class="hs-identifier hs-var">SESolve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ERROR: No solution&quot;</span></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679619169"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679619169"><span class="hs-identifier hs-var">mark</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619167"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619167"><span class="hs-identifier hs-var">showAns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619165"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619165"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679619174"><span class="hs-identifier hs-var">_tmAnswer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679619159"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619159"><span class="hs-identifier hs-var">ex</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SolutionError String
</span><a href="#local-6989586621679619164"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
</span><a href="AOC.Util.html#strip"><span class="hs-identifier hs-var">strip</span></a></span><span class="hs-glyph">-&gt;</span><span id="local-6989586621679619158"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619158"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619158"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619159"><span class="hs-identifier hs-var">ex</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#10003;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#10007;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619159"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">SolutionError
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#10007;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679619159"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679619170"><span class="annot"><span class="annottext">color :: Color
</span><a href="#local-6989586621679619170"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679619165"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Green</span></span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Red</span></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">ANSI.Blue</span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | Do the action with a given ANSI foreground color and intensity.</span><span>
</span><span id="line-390"></span><span class="annot"><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-type">withColor</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ANSI.ColorIntensity</span></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ANSI.Color</span></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span id="withColor"><span class="annot"><span class="annottext">withColor :: ColorIntensity -&gt; Color -&gt; IO () -&gt; IO ()
</span><a href="AOC.Run.html#withColor"><span class="hs-identifier hs-var hs-var">withColor</span></a></span></span><span> </span><span id="local-6989586621679619157"><span class="annot"><span class="annottext">ColorIntensity
</span><a href="#local-6989586621679619157"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621679619156"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619156"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679619155"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679619155"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><span class="annottext">[SGR] -&gt; IO ()
</span><span class="hs-identifier hs-var">ANSI.setSGR</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConsoleLayer -&gt; ColorIntensity -&gt; Color -&gt; SGR
</span><span class="hs-identifier hs-var">ANSI.SetColor</span></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><span class="hs-identifier hs-var">ANSI.Foreground</span></span><span> </span><span class="annot"><span class="annottext">ColorIntensity
</span><a href="#local-6989586621679619157"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679619156"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679619155"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="annottext">[SGR] -&gt; IO ()
</span><span class="hs-identifier hs-var">ANSI.setSGR</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SGR
</span><span class="hs-identifier hs-var">ANSI.Reset</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621679620268"><span id="local-6989586621679620269"><span id="local-6989586621679620270"><span class="annot"><a href="AOC.Run.html#pullMap"><span class="hs-identifier hs-type">pullMap</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679620270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679620269"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679620268"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679620270"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679620269"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679620268"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-403"></span><span id="pullMap"><span class="annot"><span class="annottext">pullMap :: forall a b c. Map a (Map b c) -&gt; Map (a, b) c
</span><a href="AOC.Run.html#pullMap"><span class="hs-identifier hs-var hs-var">pullMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((a, b), c)] -&gt; Map (a, b) c
forall k a. [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromDistinctAscList</span></span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">([((a, b), c)] -&gt; Map (a, b) c)
-&gt; (Map a (Map b c) -&gt; [((a, b), c)])
-&gt; Map a (Map b c)
-&gt; Map (a, b) c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, Map b c) -&gt; [((a, b), c)]) -&gt; [(a, Map b c)] -&gt; [((a, b), c)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [(b, c)] -&gt; [((a, b), c)]) -&gt; (a, [(b, c)]) -&gt; [((a, b), c)]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [(b, c)] -&gt; [((a, b), c)]
forall {p :: * -&gt; * -&gt; *} {t} {a} {c}.
Bifunctor p =&gt;
t -&gt; [p a c] -&gt; [p (t, a) c]
</span><a href="#local-6989586621679619145"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">((a, [(b, c)]) -&gt; [((a, b), c)])
-&gt; ((a, Map b c) -&gt; (a, [(b, c)])) -&gt; (a, Map b c) -&gt; [((a, b), c)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map b c -&gt; [(b, c)]) -&gt; (a, Map b c) -&gt; (a, [(b, c)])
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Map b c -&gt; [(b, c)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toAscList</span></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><span class="annottext">([(a, Map b c)] -&gt; [((a, b), c)])
-&gt; (Map a (Map b c) -&gt; [(a, Map b c)])
-&gt; Map a (Map b c)
-&gt; [((a, b), c)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map a (Map b c) -&gt; [(a, Map b c)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toAscList</span></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679619145"><span class="annot"><span class="annottext">go :: t -&gt; [p a c] -&gt; [p (t, a) c]
</span><a href="#local-6989586621679619145"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679619141"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619141"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(p a c -&gt; p (t, a) c) -&gt; [p a c] -&gt; [p (t, a) c]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((p a c -&gt; p (t, a) c) -&gt; [p a c] -&gt; [p (t, a) c])
-&gt; ((a -&gt; (t, a)) -&gt; p a c -&gt; p (t, a) c)
-&gt; (a -&gt; (t, a))
-&gt; [p a c]
-&gt; [p (t, a) c]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (t, a)) -&gt; p a c -&gt; p (t, a) c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679619141"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621679620257"><span id="local-6989586621679620258"><span id="local-6989586621679620259"><span class="annot"><a href="AOC.Run.html#pushMap"><span class="hs-identifier hs-type">pushMap</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679620259"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679620259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679620258"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679620257"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679620259"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679620258"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679620257"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-413"></span><span id="pushMap"><span class="annot"><span class="annottext">pushMap :: forall a b c. Eq a =&gt; Map (a, b) c -&gt; Map a (Map b c)
</span><a href="AOC.Run.html#pushMap"><span class="hs-identifier hs-var hs-var">pushMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(b, c)] -&gt; Map b c) -&gt; Map a [(b, c)] -&gt; Map a (Map b c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[(b, c)] -&gt; Map b c
forall k a. [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromDistinctAscList</span></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">(Map a [(b, c)] -&gt; Map a (Map b c))
-&gt; (Map (a, b) c -&gt; Map a [(b, c)])
-&gt; Map (a, b) c
-&gt; Map a (Map b c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([(b, c)] -&gt; [(b, c)] -&gt; [(b, c)])
-&gt; [(a, [(b, c)])] -&gt; Map a [(b, c)]
forall k a. Eq k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromAscListWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(b, c)] -&gt; [(b, c)] -&gt; [(b, c)])
-&gt; [(b, c)] -&gt; [(b, c)] -&gt; [(b, c)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[(b, c)] -&gt; [(b, c)] -&gt; [(b, c)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="annottext">([(a, [(b, c)])] -&gt; Map a [(b, c)])
-&gt; (Map (a, b) c -&gt; [(a, [(b, c)])])
-&gt; Map (a, b) c
-&gt; Map a [(b, c)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(((a, b), c) -&gt; (a, [(b, c)])) -&gt; [((a, b), c)] -&gt; [(a, [(b, c)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, b) -&gt; c -&gt; (a, [(b, c)])) -&gt; ((a, b), c) -&gt; (a, [(b, c)])
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; c -&gt; (a, [(b, c)])
forall {a} {a} {b}. (a, a) -&gt; b -&gt; (a, [(a, b)])
</span><a href="#local-6989586621679619135"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><span class="annottext">([((a, b), c)] -&gt; [(a, [(b, c)])])
-&gt; (Map (a, b) c -&gt; [((a, b), c)])
-&gt; Map (a, b) c
-&gt; [(a, [(b, c)])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map (a, b) c -&gt; [((a, b), c)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toAscList</span></span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-418"></span><span>    </span><span id="local-6989586621679619135"><span class="annot"><span class="annottext">go :: (a, a) -&gt; b -&gt; (a, [(a, b)])
</span><a href="#local-6989586621679619135"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679619134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619134"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619133"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679619132"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679619132"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619134"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679619133"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679619132"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span></pre></body></html>